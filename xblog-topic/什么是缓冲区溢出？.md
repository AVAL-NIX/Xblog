---
submitToken: F90FE7018EA9C62EEF569F877C80BB3EE72D7EF01F28AE5AC15BFC930A6C81B8
title: 什么是缓冲区溢出？
channel: topic
labels: 操作系统
---

> C 语言使用运行时栈来存储过程信息。每个函数的信息存储在一个栈帧中，包括寄存器、局部变量、参数、返回地址等。C 对于数组引用不进行任何边界检查，因此**对越界的数组元素的写操作会破坏存储在栈中的状态信息**，这种现象称为缓冲区溢出。缓冲区溢出会破坏程序运行，也可以被用来进行攻击计算机，如使用一个指向攻击代码的指针覆盖返回地址。

## 缓冲区溢出的防范方式

> 防范缓冲区溢出攻击的机制有三种：随机化、栈保护和限制可执行代码区域。

- **随机化**：包括栈随机化（程序开始时在栈上分配一段随机大小的空间）和地址空间布局随机化（Address-Space Layout Randomization，ASLR，即每次运行时程序的不同部分，包括代码段、数据段、栈、堆等都会被加载到内存空间的不同区域），但只能增加攻击一个系统的难度，不能完全保证安全。

- **栈保护**：在每个函数的栈帧的局部变量和栈状态之间存储一个随机产生的特殊的值，称为金丝雀值（canary）。在恢复寄存器状态和函数返回之前，程序检测这个金丝雀值是否被改变了，如果是，那么程序异常终止。

- **限制可执行代码区域**：内存页的访问形式有三种：可读、可写、可执行，只有编译器产生的那部分代码所处的内存才是可执行的，其他页限制为只允许读和写。

[点击更详细参考](https://imageslr.github.io/2020/07/08/tech-interview.html#stackoverflow)
